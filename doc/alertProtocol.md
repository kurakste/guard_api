Новая тревога.
1) Пользователь передает объект тревоги (событие в сокете: "newAlert"): 
    {
      uid: xxxx // id пользователя в базе данных;
      aid: null // здесь будет id тревоги из базы
      time: null // здесь сервер проставит время (timestamp)
      track: [ {lat: xx, lon: xx}, null] // трэк первая координата - место вызова охраны. 
    }
2) Тревога записывается в базу данных со статусом новая.
3) В тревогу проставляется время создания и id из базы данных.
4) Тревога отправляется клиенту с aid - клиент записывает себе aid.
5) Сервер оповещает всех операторов что случилась тревога (отправляет объект).

Изменение трека в тревоге: 
1) Пользователь отправляет обновленный объект тревоги. Мы понимаем что изменялся только трекинг. (событие в сокете: "trackUpdate")
2) Мы по aid обновляем объект тревоги (массив с координатами) в базе данных. 
3) Отправляем обновленную тревогу операторам. 

Изменение статуса тревоги операторами: 

Оператор взял тревогу в обработку:
0,5) сервер пытается забронировать деньги на карте. Если удачно то все остальное.
1) отправляет объект тревоги в котором выставлен uid оператора.  (событие в сокете: "alertInWork")
2) Сервер проставляет время. Меняет статус с "новая" на "на обработке".
3) Сервер обновляет запись в базе данных. 

Оператор отправил группу:
1) отправляет объект тревоги в котором: (событие в сокете:  "gbrSent")
   a) выставлен uid оператора. 
   б) могут быть проставлены комментарии. Нужно передавать и сохранять. 
   г) меняет статус тревоги с "на обработке" на "группа отправлена"
2) сервер  проставляет время
3) сервер обновляет объект в базе данных.


Оператор отменил тревогу:
1) отправляет объект тревоги в котором: (событие в сокете: "alertDecline")
   a) выставлен uid оператора. 
   б) Должны быть проставлены комментарии. Нужно передавать и сохранять. 
   г) меняет статус тревоги с "на обработке" на "отменена"
   д) отмена бронирования денег
2) сервер  проставляет время
3) сервер обновляет объект в базе данных.


Оператор закрыл тревогу:
1) Оператор дергает: (событие в сокете: alertClose) передает объект тревоги; 
2) Сервер проставляет время.
2,5) Сервер меняет тип тревоги на "закрыта"
3) Обновляет комментарий.
4) Обновляет запись в базе данных (время закрытия и комментарий)
5) Оповещает клиента и операторов что тревога закрыта - удаляем из базы.


====
На старте сервера и на случай его падения мы открываем все тревоги у которых не 
проставлен статус "отменена" и "закрыта"
Нужно что бы операторам переоткрылись все их события. 
А если есть событие оператор которого еще не подключился?
Операторы будут переподключаться с определенной задержкой. 
а если оператор не соможет подключиться?